print(n_ale)
if (n_ale > tasa){
return("MUERTO")
} else{
return("VIVO")
}
}
chequear_vida("Negro")
# --- 3. EVALUAR SUPERVIVENCIA ---
# Crea una función 'chequear_vida' que use un número aleatorio (runif())
# para decidir si el ratón sobrevive según su fenotipo y las tasas de la config.
# Si la tasa de supervivencia es mayor que el número aleatorio, el ratón vive
# Filtra 'p0' para obtener el dataframe 'supervivientes'.
chequear_vida <- function(fenotipo){
if (fenotipo == "Negro"){
tasa <- config$tasa_supervivencia_N
} else{
tasa <- config$tasa_supervivencia_C
}
n_ale <- runif(1)
print(n_ale)
if (n_ale > tasa){
return("MUERTO")
} else{
return("VIVO")
}
}
chequear_vida("Negro")
# --- 3. EVALUAR SUPERVIVENCIA ---
# Crea una función 'chequear_vida' que use un número aleatorio (runif())
# para decidir si el ratón sobrevive según su fenotipo y las tasas de la config.
# Si la tasa de supervivencia es mayor que el número aleatorio, el ratón vive
# Filtra 'p0' para obtener el dataframe 'supervivientes'.
chequear_vida <- function(fenotipo){
if (fenotipo == "Negro"){
tasa <- config$tasa_supervivencia_N
} else{
tasa <- config$tasa_supervivencia_C
}
n_ale <- runif(1)
print(n_ale)
if (n_ale > tasa){
return("MUERTO")
} else{
return("VIVO")
}
}
chequear_vida("Negro")
runif()
?runif
chequear_vida("Negro")
chequear_vida("Negro")
# --- 3. EVALUAR SUPERVIVENCIA ---
# Crea una función 'chequear_vida' que use un número aleatorio (runif())
# para decidir si el ratón sobrevive según su fenotipo y las tasas de la config.
# Si la tasa de supervivencia es mayor que el número aleatorio, el ratón vive
# Filtra 'p0' para obtener el dataframe 'supervivientes'.
chequear_vida <- function(fenotipo){
if (fenotipo == "Negro"){
tasa <- config$tasa_supervivencia_N
} else{
tasa <- config$tasa_supervivencia_C
}
n_ale <- runif(1)
print(n_ale)
if (n_ale > tasa){
return("MUERTO")
} else{
return("VIVO")
}
}
supervivencia <- sapply(p0$Fenotipo)
supervivencia <- sapply(p0$Fenotipo, chequear_vida)
# --- 3. EVALUAR SUPERVIVENCIA ---
# Crea una función 'chequear_vida' que use un número aleatorio (runif())
# para decidir si el ratón sobrevive según su fenotipo y las tasas de la config.
# Si la tasa de supervivencia es mayor que el número aleatorio, el ratón vive
# Filtra 'p0' para obtener el dataframe 'supervivientes'.
chequear_vida <- function(fenotipo){
if (fenotipo == "Negro"){
tasa <- config$tasa_supervivencia_N
} else{
tasa <- config$tasa_supervivencia_C
}
n_ale <- runif(1)
if (n_ale > tasa){
return("MUERTO")
} else{
return("VIVO")
}
}
supervivencia <- sapply(p0$Fenotipo, chequear_vida)
supervivencia <- sapply(p0$Fenotipo, chequear_vida)
p0$Superviviencia <- supervivencia
# CONTEXTO: Estudiamos ratones de campo.
# Genética: Alelo 'N' (Negro - Dominante) y Alelo 'c' (Canela - Recesivo).
# Los ratones negros se camuflan mejor en la tierra oscura.
set.seed(1258)
# --- 1. ESTABLECER PARÁMETROS ---
# Crea una lista 'config' con:
# n_inicial = 100
# tasa_supervivencia_N = 0.8
# tasa_supervivencia_c = 0.4
# n_hijos_por_pareja = 1:4 cada pareja tiene entre 1 y 4 hijos
config <- list(n_inicial = 100, tasa_supervivencia_N = 0.8, tasa_supervivencia_C = 0.4, n_hijos_por_pareja = 1:4)
# --- 2. GENERAR DATASET INICIAL (Población P0) ---
# Crea un dataframe 'p0' con 100 ratones:
# - ID, Sexo (Macho/Hembra),
# - Genotipo ("NN", "Nc", "cc") AZAR
# - Sexo ("MACHO", "HEMBRA") AZAR
# - Fenotipo: (Si tiene 'N' es "Negro", si no es "Canela"). # usar ifelse y substring
id <- 1:config$n_inicial # mejor usar eso por si queremos modificarlo en parámetros
genotipo <- sample(c("NN", "Nc", "cc"), length(id), replace = TRUE)
sexo <- sample(c("MACHO","HEMBRA"), length(id), replace = TRUE)
fenotipo <- ifelse(substring(genotipo, 1, 1) == "N", "Negro", "Canela")
p0 <- data.frame(ID = id, Genotipo = genotipo, Fenotipo = fenotipo, Sexo = sexo)
# --- 3. EVALUAR SUPERVIVENCIA ---
# Crea una función 'chequear_vida' que use un número aleatorio (runif())
# para decidir si el ratón sobrevive según su fenotipo y las tasas de la config.
# Si la tasa de supervivencia es mayor que el número aleatorio, el ratón vive
# Filtra 'p0' para obtener el dataframe 'supervivientes'.
chequear_vida <- function(fenotipo){
if (fenotipo == "Negro"){
tasa <- config$tasa_supervivencia_N
} else{
tasa <- config$tasa_supervivencia_C
}
n_ale <- runif(1)
if (n_ale > tasa){
return("MUERTO")
} else{
return("VIVO")
}
}
supervivencia <- sapply(p0$Fenotipo, chequear_vida)
p0$Superviviencia <- supervivencia
supervivientes <- p0[p0$Superviviencia == "VIVO",]
machos <- supervivientes[supervivientes$Sexo == "MACHO",]
hembras <- supervivientes[supervivientes$Sexo == "HEMBRA",]
n_parejas <- min(nrow(machos), nrow(hembras))
# CONTEXTO: Estudiamos ratones de campo.
# Genética: Alelo 'N' (Negro - Dominante) y Alelo 'c' (Canela - Recesivo).
# Los ratones negros se camuflan mejor en la tierra oscura.
set.seed(1258)
# --- 1. ESTABLECER PARÁMETROS ---
# Crea una lista 'config' con:
# n_inicial = 100
# tasa_supervivencia_N = 0.8
# tasa_supervivencia_c = 0.4
# n_hijos_por_pareja = 1:4 cada pareja tiene entre 1 y 4 hijos
config <- list(n_inicial = 100, tasa_supervivencia_N = 0.8, tasa_supervivencia_C = 0.4, n_hijos_por_pareja = 1:4)
# --- 2. GENERAR DATASET INICIAL (Población P0) ---
# Crea un dataframe 'p0' con 100 ratones:
# - ID, Sexo (Macho/Hembra),
# - Genotipo ("NN", "Nc", "cc") AZAR
# - Sexo ("MACHO", "HEMBRA") AZAR
# - Fenotipo: (Si tiene 'N' es "Negro", si no es "Canela"). # usar ifelse y substring
id <- 1:config$n_inicial # mejor usar eso por si queremos modificarlo en parámetros
genotipo <- sample(c("NN", "Nc", "cc"), length(id), replace = TRUE)
sexo <- sample(c("MACHO","HEMBRA"), length(id), replace = TRUE)
fenotipo <- ifelse(substring(genotipo, 1, 1) == "N", "Negro", "Canela")
p0 <- data.frame(ID = id, Genotipo = genotipo, Fenotipo = fenotipo, Sexo = sexo)
# --- 3. EVALUAR SUPERVIVENCIA ---
# Crea una función 'chequear_vida' que use un número aleatorio (runif())
# para decidir si el ratón sobrevive según su fenotipo y las tasas de la config.
# Si la tasa de supervivencia es mayor que el número aleatorio, el ratón vive
# Filtra 'p0' para obtener el dataframe 'supervivientes'.
chequear_vida <- function(fenotipo){
if (fenotipo == "Negro"){
tasa <- config$tasa_supervivencia_N
} else{
tasa <- config$tasa_supervivencia_C
}
n_ale <- runif(1)
if (n_ale > tasa){
return("MUERTO")
} else{
return("VIVO")
}
}
supervivencia <- sapply(p0$Fenotipo, chequear_vida)
p0$Superviviencia <- supervivencia
supervivientes <- p0[p0$Superviviencia == "VIVO",]
# --- 4. NUEVA GENERACIÓN (Población P1) ---
# Este es el reto técnico. Debes crear una función 'simular_reproduccion':
# A) Separar supervivientes en dos listas: machos y hembras.
# B) Emparejarlos (el número de parejas será el mínimo entre machos y hembras).
# C) Por cada pareja, generar entre 1 y 4 hijos:
#    - El genotipo de cada hijo sale de combinar un alelo al azar de cada padre.
#    - El sexo de cada hijo es al azar (50/50).
machos <- supervivientes[supervivientes$Sexo == "MACHO",]
hembras <- supervivientes[supervivientes$Sexo == "HEMBRA",]
n_parejas <- min(nrow(machos), nrow(hembras))
machos <- supervivientes[supervivientes$Sexo == "MACHO",]
hembras <- supervivientes[supervivientes$Sexo == "HEMBRA",]
n_parejas <- min(nrow(machos), nrow(hembras))
machos_seleccionados <- sample(machos$ID, n_parejas) # usaríamos replace si suponemos que un macho puede emparejarse con varias hembras, no es el caso
hembras_seleccionados <- sample(hembras$ID, n_parejas)
parejas <- sapply(1:n_parejas, function(i){
macho <- machos_seleccionados[i]
hembra <- hembras_seleccionados[i]
pareja <- supervivientes[supervivientes$ID %in% c(macho, hembra),]
return(pareja)
})
parejas <- lapply(1:n_parejas, function(i){
macho <- machos_seleccionados[i]
hembra <- hembras_seleccionados[i]
pareja <- supervivientes[supervivientes$ID %in% c(macho, hembra),]
return(pareja)
})
pareja <- parejas[[1]]
gen_macho <- pareja[pareja$Sexo == "MACHO", "Genotipo"]
gen_hembra <- pareja[pareja$Sexo == "HEMBRA", "Genotipo"]
genotipo <- gen_hembra
alelos <- unlist(strsplit(genotipo, ""))
extraer_alelos <- function(genotipo){
alelos <- unlist(strsplit(genotipo, ""))
alelo_seleccionado <- sample(alelos, 1)
return(alelo_seleccionado)
}
gen_macho <- pareja[pareja$Sexo == "MACHO", "Genotipo"]
gen_hembra <- pareja[pareja$Sexo == "HEMBRA", "Genotipo"]
alelo_macho <- extraer_alelos(gen_macho)
alelo_hembra <- extraer_alelos(gen_hembra)
n_hijos <- sample(parametros$n_inicial, 1)
n_hijos <- sample(config$n_hijos_por_pareja, 1)
n_hijos <- sample(config$n_hijos_por_pareja, 1)
n_hijos <- sample(config$n_hijos_por_pareja, 1)
hijos <- c()
gen_macho <- pareja[pareja$Sexo == "MACHO", "Genotipo"]
gen_hembra <- pareja[pareja$Sexo == "HEMBRA", "Genotipo"]
n_hijos <- sample(config$n_hijos_por_pareja, 1)
hijos <- c()
for (i in 1:n_hijos){
alelo_macho <- extraer_alelos(gen_macho)
alelo_hembra <- extraer_alelos(gen_hembra)
hijos <- c(hijos, paste0(alelo_macho, alelo_hembra))
}
hijos <- c()
for (i in 1:n_hijos){
alelo_macho <- extraer_alelos(gen_macho)
alelo_hembra <- extraer_alelos(gen_hembra)
hijo <- paste0(alelo_macho, alelo_hembra)
if (hijo == "cN"){
hijo <- "Nc"
}
hijos <- c(hijos, hijo)
}
simular_reproduccion <- function(pareja){
gen_macho <- pareja[pareja$Sexo == "MACHO", "Genotipo"]
gen_hembra <- pareja[pareja$Sexo == "HEMBRA", "Genotipo"]
n_hijos <- sample(config$n_hijos_por_pareja, 1)
hijos <- c()
for (i in 1:n_hijos){
alelo_macho <- extraer_alelos(gen_macho)
alelo_hembra <- extraer_alelos(gen_hembra)
hijo <- paste0(alelo_macho, alelo_hembra)
if (hijo == "cN"){
hijo <- "Nc"
}
hijos <- c(hijos, hijo)
}
genotipo <- hijos
sexo <- sample(c("MACHO","HEMBRA"), length(hijos), replace = TRUE)
fenotipo <- ifelse(substring(genotipo, 1, 1) == "N", "Negro", "Canela")
p1 <- data.frame(Genotipo = genotipo, Fenotipo = fenotipo, Sexo = sexo)
return(p1)
}
nueva_generacion <- lapply(parejas, simular_reproduccion)
p1 <- do.call(rbind, nueva_generacion)
p1
nueva_generacion <- lapply(parejas, simular_reproduccion)
p1 <- do.call(rbind, nueva_generacion)
p1$ID <- 1:nrow(p1)
p1
set.seed(1258)
# --- 1. ESTABLECER PARÁMETROS ---
# Crea una lista 'config' con:
# n_inicial = 100
# tasa_supervivencia_N = 0.8
# tasa_supervivencia_c = 0.6
# n_hijos_por_pareja = 1:8 cada pareja tiene entre 1 y 8 hijos
config <- list(n_inicial = 100, tasa_supervivencia_N = 0.8, tasa_supervivencia_C = 0.6, n_hijos_por_pareja = 1:8)
# --- 2. GENERAR DATASET INICIAL (Población P0) ---
# Crea un dataframe 'p0' con 100 ratones:
# - ID, Sexo (Macho/Hembra),
# - Genotipo ("NN", "Nc", "cc") AZAR
# - Sexo ("MACHO", "HEMBRA") AZAR
# - Fenotipo: (Si tiene 'N' es "Negro", si no es "Canela"). # usar ifelse y substring
id <- 1:config$n_inicial # mejor usar eso por si queremos modificarlo en parámetros
genotipo <- sample(c("NN", "Nc", "cc"), length(id), replace = TRUE)
sexo <- sample(c("MACHO","HEMBRA"), length(id), replace = TRUE)
fenotipo <- ifelse(substring(genotipo, 1, 1) == "N", "Negro", "Canela")
p0 <- data.frame(ID = id, Genotipo = genotipo, Fenotipo = fenotipo, Sexo = sexo)
# --- 3. EVALUAR SUPERVIVENCIA ---
# Crea una función 'chequear_vida' que use un número aleatorio (runif())
# para decidir si el ratón sobrevive según su fenotipo y las tasas de la config.
# Si la tasa de supervivencia es mayor que el número aleatorio, el ratón vive
# Filtra 'p0' para obtener el dataframe 'supervivientes'.
chequear_vida <- function(fenotipo){
if (fenotipo == "Negro"){
tasa <- config$tasa_supervivencia_N
} else{
tasa <- config$tasa_supervivencia_C
}
n_ale <- runif(1)
if (n_ale > tasa){
return("MUERTO")
} else{
return("VIVO")
}
}
supervivencia <- sapply(p0$Fenotipo, chequear_vida)
p0$Superviviencia <- supervivencia
supervivientes <- p0[p0$Superviviencia == "VIVO",]
machos <- supervivientes[supervivientes$Sexo == "MACHO",]
hembras <- supervivientes[supervivientes$Sexo == "HEMBRA",]
n_parejas <- min(nrow(machos), nrow(hembras))
machos_seleccionados <- sample(machos$ID, n_parejas) # usaríamos replace si suponemos que un macho puede emparejarse con varias hembras, no es el caso
hembras_seleccionados <- sample(hembras$ID, n_parejas)
parejas <- lapply(1:n_parejas, function(i){
macho <- machos_seleccionados[i]
hembra <- hembras_seleccionados[i]
pareja <- supervivientes[supervivientes$ID %in% c(macho, hembra),]
return(pareja)
})
pareja <- parejas[[1]]
extraer_alelos <- function(genotipo){
alelos <- unlist(strsplit(genotipo, ""))
alelo_seleccionado <- sample(alelos, 1)
return(alelo_seleccionado)
}
simular_reproduccion <- function(pareja){
gen_macho <- pareja[pareja$Sexo == "MACHO", "Genotipo"]
gen_hembra <- pareja[pareja$Sexo == "HEMBRA", "Genotipo"]
n_hijos <- sample(config$n_hijos_por_pareja, 1)
hijos <- c()
for (i in 1:n_hijos){
alelo_macho <- extraer_alelos(gen_macho)
alelo_hembra <- extraer_alelos(gen_hembra)
hijo <- paste0(alelo_macho, alelo_hembra)
if (hijo == "cN"){
hijo <- "Nc"
}
hijos <- c(hijos, hijo)
}
genotipo <- hijos
sexo <- sample(c("MACHO","HEMBRA"), length(hijos), replace = TRUE)
fenotipo <- ifelse(substring(genotipo, 1, 1) == "N", "Negro", "Canela")
p1 <- data.frame(Genotipo = genotipo, Fenotipo = fenotipo, Sexo = sexo)
return(p1)
}
nueva_generacion <- lapply(parejas, simular_reproduccion)
p1 <- do.call(rbind, nueva_generacion)
p1$ID <- 1:nrow(p1)
p1
# --- 5. EXPORTAR RESULTADOS ---
# A) Crea una carpeta "Simulacion_Ratones".
dir.create("Simulacion_Ratones", showWarnings = F)
# Escritura de Ficheros Excel
# Es ideal para compartir datos con personas que no usan R.
write.xlsx(iris, file="iris.xlsx", sheetName="sheet1", row.names=FALSE)
## Ficheros Excel
# install.packages("xlsx)
library(xlsx)
# Escritura de Ficheros Excel
# Es ideal para compartir datos con personas que no usan R.
write.xlsx(iris, file="iris.xlsx", sheetName="sheet1", row.names=FALSE)
write.xlsx(iris, file="iris.xlsx", sheetName="sheet2", append=TRUE, row.names=FALSE)
# Escritura de Ficheros Excel
# Es ideal para compartir datos con personas que no usan R.
write.xlsx(iris, file="iris.xlsx", sheetName="sheet1", row.names=FALSE)
# Lectura de Ficheros Excel
# Podemos especificar el nombre de la hoja si tuviera varias.
read.xlsx("iris.xlsx", sheetIndex = 1)
### ======================================================================== ###
###           PROYECTO FINAL: SIMULADOR DE EVOLUCIÓN EN RATONES              ###
### ======================================================================== ###
# CONTEXTO: Estudiamos ratones de campo.
# Genética: Alelo 'N' (Negro - Dominante) y Alelo 'c' (Canela - Recesivo).
# Los ratones negros se camuflan mejor en la tierra oscura.
set.seed(1258)
# --- 1. ESTABLECER PARÁMETROS ---
# Crea una lista 'config' con:
# n_inicial = 100
# tasa_supervivencia_N = 0.8
# tasa_supervivencia_c = 0.4
# n_hijos_por_pareja = 1:4 cada pareja tiene entre 1 y 4 hijos
# --- 2. GENERAR DATASET INICIAL (Población P0) ---
# Crea un dataframe 'p0' con 100 ratones:
# - ID, Sexo (Macho/Hembra),
# - Genotipo ("NN", "Nc", "cc") AZAR
# - Sexo ("MACHO", "HEMBRA") AZAR
# - Fenotipo: (Si tiene 'N' es "Negro", si no es "Canela"). # usar ifelse y substring
# --- 3. EVALUAR SUPERVIVENCIA ---
# Crea una función 'chequear_vida' que use un número aleatorio (runif())
# para decidir si el ratón sobrevive según su fenotipo y las tasas de la config.
# Si la tasa de supervivencia es mayor que el número aleatorio, el ratón vive
# Filtra 'p0' para obtener el dataframe 'supervivientes'.
# --- 4. NUEVA GENERACIÓN (Población P1) ---
# Este es el reto técnico. Debes crear una función 'simular_reproduccion':
# A) Separar supervivientes en dos listas: machos y hembras.
# B) Emparejarlos (el número de parejas será el mínimo entre machos y hembras).
# C) Por cada pareja, generar entre 1 y 4 hijos:
#    - El genotipo de cada hijo sale de combinar un alelo al azar de cada padre.
#    - El sexo de cada hijo es al azar (50/50).
# --- 5. EXPORTAR RESULTADOS ---
# A) Crea una carpeta "Simulacion_Ratones".
# B) Guarda P0 y P1 en un Excel con dos hojas.
# C) Crea un log de texto que resuma si la población creció o disminuyó.
# D) Comprime todo en "Resultado_Evolucion.zip".
### ======================================================================== ###
### ======================================================================== ###
###           PROYECTO FINAL: SIMULADOR DE EVOLUCIÓN EN RATONES              ###
### ======================================================================== ###
# CONTEXTO: Estudiamos ratones de campo.
# Genética: Alelo 'N' (Negro - Dominante) y Alelo 'c' (Canela - Recesivo).
# Los ratones negros se camuflan mejor en la tierra oscura.
set.seed(1258)
# --- 1. ESTABLECER PARÁMETROS ---
# Crea una lista 'config' con:
# n_inicial = 100
# tasa_supervivencia_N = 0.8
# tasa_supervivencia_c = 0.6
# n_hijos_por_pareja = 1:8 cada pareja tiene entre 1 y 8 hijos
config <- list(n_inicial = 100, tasa_supervivencia_N = 0.8, tasa_supervivencia_C = 0.6, n_hijos_por_pareja = 1:8)
# --- 2. GENERAR DATASET INICIAL (Población P0) ---
# Crea un dataframe 'p0' con 100 ratones:
# - ID, Sexo (Macho/Hembra),
# - Genotipo ("NN", "Nc", "cc") AZAR
# - Sexo ("MACHO", "HEMBRA") AZAR
# - Fenotipo: (Si tiene 'N' es "Negro", si no es "Canela"). # usar ifelse y substring
id <- 1:config$n_inicial # mejor usar eso por si queremos modificarlo en parámetros
genotipo <- sample(c("NN", "Nc", "cc"), length(id), replace = TRUE)
sexo <- sample(c("MACHO","HEMBRA"), length(id), replace = TRUE)
fenotipo <- ifelse(substring(genotipo, 1, 1) == "N", "Negro", "Canela")
p0 <- data.frame(ID = id, Genotipo = genotipo, Fenotipo = fenotipo, Sexo = sexo)
# --- 3. EVALUAR SUPERVIVENCIA ---
# Crea una función 'chequear_vida' que use un número aleatorio (runif())
# para decidir si el ratón sobrevive según su fenotipo y las tasas de la config.
# Si la tasa de supervivencia es mayor que el número aleatorio, el ratón vive
# Filtra 'p0' para obtener el dataframe 'supervivientes'.
chequear_vida <- function(fenotipo){
if (fenotipo == "Negro"){
tasa <- config$tasa_supervivencia_N
} else{
tasa <- config$tasa_supervivencia_C
}
n_ale <- runif(1)
if (n_ale > tasa){
return("MUERTO")
} else{
return("VIVO")
}
}
supervivencia <- sapply(p0$Fenotipo, chequear_vida)
p0$Superviviencia <- supervivencia
supervivientes <- p0[p0$Superviviencia == "VIVO",]
# --- 4. NUEVA GENERACIÓN (Población P1) ---
# Este es el reto técnico. Debes crear una función 'simular_reproduccion':
# A) Separar supervivientes en dos tablas: machos y hembras.
# B) Emparejarlos (el número de parejas será el mínimo entre machos y hembras).
# C) Por cada pareja, generar entre 1 y 4 hijos:
#    - El genotipo de cada hijo sale de combinar un alelo al azar de cada padre.
#    - El sexo de cada hijo es al azar (50/50).
machos <- supervivientes[supervivientes$Sexo == "MACHO",]
hembras <- supervivientes[supervivientes$Sexo == "HEMBRA",]
n_parejas <- min(nrow(machos), nrow(hembras))
machos_seleccionados <- sample(machos$ID, n_parejas) # usaríamos replace si suponemos que un macho puede emparejarse con varias hembras, no es el caso
hembras_seleccionados <- sample(hembras$ID, n_parejas)
parejas <- lapply(1:n_parejas, function(i){
macho <- machos_seleccionados[i]
hembra <- hembras_seleccionados[i]
pareja <- supervivientes[supervivientes$ID %in% c(macho, hembra),]
return(pareja)
})
pareja <- parejas[[1]]
extraer_alelos <- function(genotipo){
alelos <- unlist(strsplit(genotipo, ""))
alelo_seleccionado <- sample(alelos, 1)
return(alelo_seleccionado)
}
simular_reproduccion <- function(pareja){
gen_macho <- pareja[pareja$Sexo == "MACHO", "Genotipo"]
gen_hembra <- pareja[pareja$Sexo == "HEMBRA", "Genotipo"]
n_hijos <- sample(config$n_hijos_por_pareja, 1)
hijos <- c()
for (i in 1:n_hijos){
alelo_macho <- extraer_alelos(gen_macho)
alelo_hembra <- extraer_alelos(gen_hembra)
hijo <- paste0(alelo_macho, alelo_hembra)
if (hijo == "cN"){
hijo <- "Nc"
}
hijos <- c(hijos, hijo)
}
genotipo <- hijos
sexo <- sample(c("MACHO","HEMBRA"), length(hijos), replace = TRUE)
fenotipo <- ifelse(substring(genotipo, 1, 1) == "N", "Negro", "Canela")
p1 <- data.frame(Genotipo = genotipo, Fenotipo = fenotipo, Sexo = sexo)
return(p1)
}
nueva_generacion <- lapply(parejas, simular_reproduccion)
p1 <- do.call(rbind, nueva_generacion)
p1$ID <- 1:nrow(p1)
p1
# --- 5. EXPORTAR RESULTADOS ---
# A) Crea una carpeta "Simulacion_Ratones".
dir.create("Simulacion_Ratones", showWarnings = F)
# B) Guarda P0 y P1 en un Excel con dos hojas.
write.xlsx(p0, file = "poblaciones.xlsx", sheetName = "p0")
write.xlsx(p1, file = "poblaciones.xlsx", sheetName = "p1")
